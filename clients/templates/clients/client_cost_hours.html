{% extends 'site/base.html' %}

{% block title %}Support Cost Calculator{% endblock %}
   
    {% block head_css_section %}
    {% endblock head_css_section %}

    {% block head_css_page %}
        <style>

        body {
            
            padding: 0;
            font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
            font-size: 14px;
        }
        .channel-link{
                
            font-size: 11px
        }

    </style>
    {% endblock head_css_page %}

{% block head_js %}
<script type="text/javascript">
    function changeClient(obj){
        urlString = "http://localhost:8000/client/client/"
        var selectedClient = obj.value;
        
        if (selectedClient.value != ""){
            window.location = urlString + selectedClient;
        }
    }
</script>
{% endblock head_js %}
{% block pagetitle %}Support Cost Form{% endblock pagetitle %}
{% block content %}
    <div class="container" id="calc">   
        <div class="row">
            <form action="/client/cost/summary/" method="post">
                {% csrf_token %}
                    <div class='hide'>
                    <input id="size" type="text" name="size" value={{ size }}>
                </div>
                <div class="row">
                    <div class="col s2 offset-s10">
                        {% verbatim %}
                        <h4>{{ totalCost }}</h4>
                        {% endverbatim %}
                    
                    </div>
                    
                
                </div>
                
                 {% for channel, languages in languages.items %}
                <div id="{{channel}}-language">
                    
                   {% for language, cost in languages.items %}
                    <div class="row">
                        <h5> {{ channel|capfirst }} {{ language|capfirst }}</h5>
                        <div col="col s4">
                            <div class='hide'>
                                <input id="channel_{{channel}}_{{language}}" type="text" name="channel_{{channel}}_{{language}}" value={{ channel }}_{{language}}>
                            </div>
                            <table>
                                <thead>
                                  <tr>
                                      <th>Hours of Support</th>
                                      <th>Monday - Friday</th>
                                      <th>Saturday - Sunday</th>
                                  </tr>
                                </thead>

                                <tbody>
                                  <tr>
                                    <td>
                                        8am - 4:30pm PST
                                    </td>
                                    <td>
                                        <input type="checkbox" id="{{channel}}-{{language}}-morning-weekday" name="{{channel}}-{{language}}-morning-weekday" value="{{ cost }}" v-model="supportCostMorningWeekday"/>
                                        <label for="{{channel}}-{{language}}-morning-weekday">${{ cost }}</label>
                                    </td>
                                    <td>
                                        <input type="checkbox" id="{{channel}}-{{language}}-morning-weekend" name="{{channel}}-{{language}}-morning-weekend" value="{{ cost }}" v-model="supportCostMorningWeekend"/>
                                        <label for="{{channel}}-{{language}}-morning-weekend"> ${{ cost }}</label>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>
                                        1:30pm - 10pm PST
                                    </td>
                                    <td>
                                        <input type="checkbox" id="{{channel}}-{{language}}-afternoon-weekday" name="{{channel}}-{{language}}-afternoon-weekday" value="{{ cost }}" v-model="supportCostAfternoonWeekday" />
                                        <label for="{{channel}}-{{language}}-afternoon-weekday">${{ cost }}</label>
                                    </td>
                                    <td>
                                        <input type="checkbox" id="{{channel}}-{{language}}-afternoon-weekend" name="{{channel}}-{{language}}-afternoon-weekend" value="{{ cost }}" v-model="supportCostAfternoonWeekend"/>
                                        <label for="{{channel}}-{{language}}-afternoon-weekend">${{ cost }}</label>
                                    </td>
                                  </tr>
                                  <tr>
                                    <td>
                                        9:30pm - 8am PST
                                    </td>
                                    <td>
                                        <input type="checkbox" id="{{channel}}-{{language}}-overnight-weekday" name="{{channel}}-{{language}}-overnight-weekday" value="{{ cost }}" v-model="supportCostOvernightWeekday"/>
                                        <label for="{{channel}}-{{language}}-overnight-weekday">${{ cost }}</label>
                                    </td>
                                    <td>
                                        <input type="checkbox" id="{{channel}}-{{language}}-overnight-weekend" name="{{channel}}-{{language}}-overnight-weekend" value="{{ cost }}" v-model="supportCostOvernightWeekend"/>
                                        <label for="{{channel}}-{{language}}-overnight-weekend">${{ cost }}</label>
                                    </td>
                                  </tr>
                                </tbody>
                              </table>
                        
                        </div>
                    </div> 
                    {% endfor %}
                </div>
                {% endfor %}
                <button class="btn waves-effect waves-light" type="submit" name="action">Submit
                        <i class="material-icons right">send</i>
                      </button>   
            </form>
            
        </div>
        
    </div>
{% endblock content %}

{% block footer_javascript_page %}
<script>
    var app = new Vue({
        el: '#calc',
        data: {
            supportCostMorningWeekday: [],
            supportCostMorningWeekend: [],
            supportCostAfternoonWeekday: [],
            supportCostAfternoonWeekend: [],
            supportCostOvernightWeekday: [],
            supportCostOvernightWeekend: []
        },
        computed: {
            totalCost(){
                var total = this.supportCostMorningWeekday.reduce((acc, item) => acc + Number(item), 0);
                total +=  this.supportCostMorningWeekend.reduce((acc, item) => acc + Number(item), 0);
                total +=  this.supportCostAfternoonWeekday.reduce((acc, item) => acc + Number(item), 0);
                total +=  this.supportCostAfternoonWeekend.reduce((acc, item) => acc + Number(item), 0);
                total +=  this.supportCostOvernightWeekday.reduce((acc, item) => acc + Number(item), 0);
                total +=  this.supportCostOvernightWeekend.reduce((acc, item) => acc + Number(item), 0);
                
                return "$" + total + "/month";
                
            }
            
        }
        
});
    
</script>

{% endblock footer_javascript_page %}
